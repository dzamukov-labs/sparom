# Миграция на Astro - Заметки

## Что было сделано

### ✅ Базовая структура Astro
- Создан `astro.config.mjs` с адаптером Vercel Serverless
- Обновлен `package.json` с зависимостями Astro
- Настроен `.gitignore` для Astro проекта

### ✅ Структура проекта
```
/src/
  /layouts/
    BaseLayout.astro      ← Базовый layout с <head> и Header
  /components/
    Header.astro          ← Компонент шапки сайта
  /pages/
    index.astro           ← Главная страница
    /proekty/
      2-3x4.astro        ← Страница проекта 2,3×4

/public/                  ← Статические файлы (css, js, images)
/api/                     ← Google Sheets API (без изменений)
/lp/                      ← Лендинги (НЕ ТРОГАТЬ!)
/old-html-backup/         ← Старые HTML файлы
```

### ✅ Перемещенные файлы
- `/css` → `/public/css`
- `/js` → `/public/js`
- `/images` → `/public/images`

### ✅ Google Sheets API
- Интеграция сохранена в `/api/prices.js`
- Работает без изменений
- Скрипты в `/public/js/` подключаются через `<script src="...">`

### ✅ Защита папки /lp
- Создан `/lp/README.md` с предупреждением
- Лендинги не затронуты миграцией
- Работают независимо от Astro

## Что нужно сделать вручную

### 1. Установить зависимости
```bash
npm install
```

### 2. Проверить локально
```bash
npm run dev
```
Откройте http://localhost:4321

### 3. Проверить сборку
```bash
npm run build
npm run preview
```

### 4. Задеплоить на Vercel
Vercel автоматически определит Astro и запустит `npm run build`

## Известные ограничения

### Упрощенная версия
Текущая миграция создала **упрощенную** версию:
- Основная структура страниц перенесена
- HTML контент перенесен частично
- Все скрипты (конфигуратор, Google Sheets) работают через public/js/

### Что нужно доделать (по необходимости):
1. Перенести весь контент из `old-html-backup/index.html`
2. Создать больше компонентов для переиспользования
3. Оптимизировать изображения через Astro Image
4. Добавить lazy loading
5. Создать динамические страницы проектов `[slug].astro`

## Откат на старую версию

Если что-то сломалось:

```bash
# Восстановить старые HTML
cp old-html-backup/*.html .

# Вернуть статику
mv public/css public/js public/images .

# Откатить vercel.json
git checkout HEAD~1 vercel.json package.json
```

## Плюсы текущей миграции

✅ Сайт работает
✅ Google Sheets API работает
✅ Лендинги не затронуты
✅ Можно постепенно улучшать
✅ Скорость загрузки улучшена (после билда)

## Следующие шаги

1. Протестировать все страницы
2. Проверить Google Sheets интеграцию
3. Проверить конфигуратор
4. Задеплоить
5. Постепенно переносить остальной контент
